<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="adminEvent">
  		
  		<select id="getNumber" resultType="String">
  			SELECT 'EV' || LPAD((SELECT count(event_code)+1 FROM EVENT),5,'0') AS code FROM dual;
  			
  		</select>
  
  		<insert id = "insertEvent" parameterType="AdminEventVO" >
    		insert into Event values
    		(#{eventCode}, #{eventName}, #{productCode}, #{evStart}, #{evEnd}. #{content}, #{thumImg}, #{isOpen}, #{insertId}, DEFAULT)
  		</insert>
  
  		<select id="eventCount" resultType="int">
  			select count(*)from EVENT ev INNER JOIN PRODUCT_INFO pr ON ev.PRODUCT_CODE = pr.PR_CODE  
  		</select>
  		
  		<select id="eventList" parameterType="hashmap" resultType="AdminEventVO">
  		<![CDATA[
  		
  		select a.*from(
	  			select aa.*, rownum r from(
	  				SELECT ev.event_code, ev.event_name, ev.product_code, ev.ev_start, ev.ev_end, ev.is_open, pr.pr_name FROM 
	  					EVENT ev INNER JOIN PRODUCT_INFO pr ON ev.PRODUCT_CODE = pr.PR_CODE  
	  				order by ev_start DESC
	  			) aa order by ev_start DESC
	  		) a where r >=#{start} and r <=#{end}
	  		

  		]]>
  	</select>
  </mapper>